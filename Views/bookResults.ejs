<% include ./partials/navbar %>

<div class="container">

  <!-- loop through the json object  -->
  <% apiResultsdata['items'].forEach(function(items) { %>
    <% let ID = items['id'] %>
    <% let volumeInfo = items['volumeInfo'] %>
    <% let author = volumeInfo['authors'] %>
    <% let title = volumeInfo['title'] %>
    <% let image = null %>
    <% if(!(volumeInfo['imageLinks'] === undefined)) { %>
      <% image = volumeInfo['imageLinks']['smallThumbnail'] %>
    <% } %>


    <% if(image !== null) { %>
      <form id="IDs">
        <option value="<%= ID %>"></option>
      </form>
    <!-- bootstrap card  -->
    <div class="card">
            <div class="row no-gutters">
                <div class="col-auto">
                    <img src="<%= image %>" class="img-fluid" alt="">
                </div>
                <div class="col">
                    <div class="card-block px-2">

                      <a class="clicklink" href="/bookDetails"><h5 class="card-title"><%= title %></h5></a>

                      <script type="text/javascript">
                          $(document).ready(function(){
                              $(".card-title").click(function() {

                                $.ajax({
                                  type: 'post',
                                  contentType: "application/json; charset=UTF-8",
                                  data: JSON.stringify({ID:'<%= ID %>'}),
                                  url: 'http://localhost:3000/bookDetails',
                                  success: function(data){
                                    console.log('success');
                                  }
                                });
                              });
                          });
                      </script>

                        <p class="card-text">By: <%= author %></p>
                        <a href="#" class="btn btn-primary">Review</a>
                        <a href="#" class="btn btn-primary">Rate</a>
                        <a href="#" class="btn btn-primary">Add to bookself</a>
                    </div>
                </div>
            </div>
            <div class="card-footer w-100 text-muted">
            </div>
        </div>

        <% } %>

    <% }) %>

</div>

<% include ./partials/footer %>
